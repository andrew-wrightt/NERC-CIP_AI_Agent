/* styling for frontend */
* { box-sizing: border-box; }
body { margin: 0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto; }
.app { max-width: 850px; margin: 0 auto; display: grid; grid-template-rows: auto 1fr auto; height: 100vh; padding: 12px; gap: 12px; }
header { display: flex; align-items: center; justify-content: space-between; }
.controls { display: flex; gap: 12px; }
label { display: flex; flex-direction: column; font-size: 12px; color: #555; }

/* status text next to upload */
#upload-status {
  padding-left: 6px;
  font-size: 12px;
  color: #64748b;
}

/* Upload Btn */
#upload {
  padding: 10px 14px;
  border: 1px solid #ddd;
  border-radius: 10px;
  background: #fff;
  cursor: pointer;
}
#upload:hover { background: #f3f3f3; }
#upload:disabled { opacity: 0.6; cursor: not-allowed; }

input, textarea, button { font: inherit; }
#chat { overflow-y: auto; padding: 8px; border: 1px solid #eee; border-radius: 12px; background: #fafafa; }
.msg { padding: 10px 12px; margin: 8px 0; border-radius: 12px; max-width: 80%; white-space: pre-wrap; }
.msg { display: flex; align-items: flex-start; gap: 10px; }
.msg .avatar {  width: 32px; height: 32px; border-radius: 50%;  background: linear-gradient(135deg,#2e88ff,#59c3ff); flex: 0 0 32px;}

/* small avatar circle if you include one in the template */
.msg.user .avatar {background: linear-gradient(135deg,#34d399,#06b6d4);}

.msg .bubble {
  /* keeps the exterior assistant background, bubble makes it look better */
  background: rgba(255,255,255,0.9);
  border: 1px solid #eee;
  border-radius: 12px;
  padding: 10px 12px;
  white-space: pre-wrap;
  box-shadow: 0 2px 10px rgba(2,6,23,.04);
}

.msg.user .bubble { background: #e6f0ff; }
.msg .content code {
  background:#0f172a0d;
  border:1px solid #e5e7eb;
  border-radius:6px;
  padding:2px 5px;
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
  font-size: .95em;
}

.user { margin-left: auto; }
    /* .assistant { background: #fff; border: 1px solid #eee; } */
    footer { display: grid; grid-template-columns: 1fr auto; gap: 10px; }

/* added sources for collapsable citations*/
.cites{ margin-top:8px;border-top:1px solid #e5e7eb;padding-top:6px; }
.cites[hidden]{ display:none; }
.cites summary{ color:#0284c7; cursor:pointer; user-select:none; }
.cites summary::-webkit-details-marker{ display:none; }
.sources{ list-style:none; margin:8px 0 0; padding:0; display:flex; flex-wrap:wrap; gap:8px; }
.sources li{background:#f1f5f9; color:#475569; border:1px solid #e2e8f0;padding:4px 10px; border-radius:999px; font-size:12px;}

/* addition for loader and nicer bubbles */
.status{
  min-height:18px;
  color:#64748b;
  font-size:12px;
  margin-top:-4px;
}

.status.loading:before{
  content:"";
  display:inline-block;
  width:14px;height:14px;margin-right:8px;
  border-radius:50%;
  border:2px solid #0ea5e9;
  border-top-color:transparent;
  animation:spin .8s linear infinite;
  vertical-align:-2px;
}

@keyframes spin{ to{ transform:rotate(360deg); } }
#prompt { width: 100%; padding: 10px; border-radius: 10px; border: 1px solid #ddd; }
#send { padding: 10px 14px; border: 1px solid #ddd; border-radius: 10px; background: #fff; cursor: pointer; }
#send:hover { background: #f3f3f3; }
#send:disabled { position: relative; color: transparent;  /* hide send icon while loading */}
#send:disabled::after { content: "";
  position: absolute; inset: 0; margin: auto;
  width: 16px; height: 16px; border-radius: 50%;
  border: 2px solid #0ea5e9; border-top-color: transparent;
  animation: spin .8s linear infinite;
}
.status {
  padding: 2px 0;
}

.msg.assistant .avatar.loading {
  background: transparent; /* hides the gradient */
  border: 4px solid rgba(46, 136, 255, 0.3); /* spinner track (light blue) */
  border-top-color: #2e88ff; /* Spinner head dark blue */
  animation: spin 0.8s linear infinite;
}

.msg.assistant { justify-content: flex-start; } 
.msg.user      { flex-direction: row-reverse;            /* avatar on right */
                 justify-content: flex-end;
                 margin-left: 0; }
.msg .bubble { max-width: calc(100% - 42px); } /* makes bubbles line up with container edges even with avatar */ 

/* fix left justification for user */
/* rows span the full width so we have room to push to the right */
.msg { width: 100%; max-width: none; }

/* default (assistant) bubble hugs the left */
.msg .bubble { margin-right: auto; margin-left: 0; }

/* user row mirrors layout: avatar on right */
.msg.user{
  flex-direction: row-reverse;      
  justify-content: flex-start;      
  margin-left: 0 !important;        /* override older ".user margin-left:auto; don't want to get rid of it */
}

/* user bubble is pushed to the right edge */
.msg.user .bubble{
  margin-left: auto;                
  margin-right: 0;
  max-width: min(80%, calc(100% - 42px));  /* 32px avatar + 10px gap */
}

/* keep avatars aligned with bubble tops */
.msg .avatar{ align-self: flex-start; }
/* assistant bubble, light blue color */
.msg.assistant .bubble{
  background: #EFF6FF;        /* soft blue */
  border-color: #CFE3FF;      /* matching light border */
}